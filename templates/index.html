{% extends "base.html" %}
{% load static %}

{% block title %}Loan Saathi Hub — Home{% endblock %}

{% block navbar %}
<ul class="navbar-nav ms-auto align-items-center">
  {% if not request.user.is_authenticated %}
    <li class="nav-item"><a class="nav-link" href="{% url 'index' %}">Home</a></li>
    <li class="nav-item"><a class="nav-link" href="{% url 'login' %}">Login</a></li>
    <li class="nav-item"><a class="nav-link" href="{% url 'register' %}">Register</a></li>
  {% else %}
    {% if not PROFILE_COMPLETE %}
      <li class="nav-item"><a class="nav-link" href="{% url 'index' %}">Home</a></li>
      <li class="nav-item"><a class="nav-link" href="{% url 'profile_form' user_id=request.user.id %}">Profile Form</a></li>
      <li class="nav-item"><a class="nav-link text-danger" href="{% url 'logout' %}">Logout</a></li>
    {% else %}
      {% if request.user.role == "applicant" %}
        <li class="nav-item"><a class="nav-link" href="{% url 'dashboard_applicant' %}">Back to Dashboard</a></li>
      {% elif request.user.role == "lender" %}
        <li class="nav-item"><a class="nav-link" href="{% url 'dashboard_lender' %}">Back to Dashboard</a></li>
      {% endif %}
      <li class="nav-item"><a class="nav-link text-danger" href="{% url 'logout' %}">Logout</a></li>
    {% endif %}
  {% endif %}
</ul>
{% endblock %}

{% block extra_head %}
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
<style>
  .btn-gradient {
    background: linear-gradient(90deg,#2563eb,#0ea5e9);
    border: none; color: #fff; font-weight:600;
    border-radius:8px; padding:10px 20px;
    transition: all .3s ease;
  }
  .btn-gradient:hover { opacity: 0.9; transform: translateY(-2px); }

  .btn-outline-light:hover { background:rgba(255,255,255,0.15); }

  .glass-card {
    background: rgba(255,255,255,0.85);
    padding:22px; border-radius:14px;
    box-shadow:0 8px 28px rgba(0,0,0,0.08);
    transition: all .3s ease;
  }
  .glass-card:hover { transform: translateY(-4px); }

  .hero {
    padding:90px 0;
    border-radius:12px;
    background:
      linear-gradient(135deg, rgba(0,0,0,0.65), rgba(0,0,0,0.65)),
      url({% static 'images/loan-bg.jpg' %}) center/cover no-repeat;
  }
  .hero h1 { text-shadow:0 6px 24px rgba(0,0,0,0.75); }
  .hero p { text-shadow:0 4px 16px rgba(0,0,0,0.6); }

  .card { border: none; border-radius:12px; }
  .card-body { padding:1.5rem; }

  .offers .card { border:1px solid #f1f5f9; transition:all .3s ease; }
  .offers .card:hover { box-shadow:0 8px 24px rgba(0,0,0,0.1); transform:translateY(-3px); }

  .accordion-button:focus { box-shadow:none; }
</style>
{% endblock %}

{% block content %}

<!-- ✅ HERO -->
<section class="hero text-center mb-5" aria-label="Hero">
  <div class="container container-max">
    <h1 class="display-4 fw-bold mb-3 text-white" data-aos="fade-down">
      Smart Loans, Smarter Choices
    </h1>
    <p class="lead mb-4 text-white opacity-90" data-aos="fade-up">
      Your all-in-one platform to compare, calculate and apply for loans.
    </p>
    <div class="d-flex justify-content-center gap-3" data-aos="zoom-in">
      <a href="{% url 'register' %}?role=applicant" class="btn btn-gradient btn-lg">
        <i class="bi bi-person-fill me-2"></i> Register as Applicant
      </a>
      <a href="{% url 'register' %}?role=lender" class="btn btn-outline-light btn-lg">
        <i class="bi bi-bank me-2"></i> Register as Lender
      </a>
    </div>
  </div>
</section>

<!-- ✅ FEATURES -->
<section class="py-5">
  <div class="container container-max text-center">
    <div class="row g-4">
      <div class="col-md-4" data-aos="fade-up">
        <div class="glass-card h-100">
          <i class="bi bi-speedometer2 fs-1 text-info"></i>
          <h5 class="mt-3">Fast Approvals</h5>
          <p class="text-muted mb-0">Get quick responses from trusted banks & NBFCs.</p>
        </div>
      </div>
      <div class="col-md-4" data-aos="fade-up" data-aos-delay="150">
        <div class="glass-card h-100">
          <i class="bi bi-shield-lock fs-1 text-success"></i>
          <h5 class="mt-3">Secure Process</h5>
          <p class="text-muted mb-0">Bank-grade security & encryption for your data.</p>
        </div>
      </div>
      <div class="col-md-4" data-aos="fade-up" data-aos-delay="300">
        <div class="glass-card h-100">
          <i class="bi bi-bar-chart-line fs-1 text-warning"></i>
          <h5 class="mt-3">Compare Offers</h5>
          <p class="text-muted mb-0">Choose the best loan offer with side-by-side comparisons.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- CALCULATORS -->
<section class="py-5" aria-label="Calculators">
  <div class="container container-max">
    <div class="row g-4 align-items-stretch">
      <div class="col-md-6" data-aos="fade-right">
        <div class="glass-card h-100">
          <h5 class="mb-3"><i class="bi bi-calculator me-2"></i> EMI Calculator</h5>
          <div class="row g-2">
            <div class="col-12 mb-2">
              <input type="number" id="loanAmount" class="form-control" placeholder="Loan Amount (₹)">
            </div>
            <div class="col-md-6 mb-2">
              <input type="number" id="interestRate" class="form-control" placeholder="Interest Rate (%)">
            </div>
            <div class="col-md-6 mb-2">
              <input type="number" id="loanTenure" class="form-control" placeholder="Tenure (months)">
            </div>
            <div class="col-12 mt-2">
              <button class="btn btn-gradient w-100" type="button" onclick="calculateEMI()">Calculate EMI</button>
            </div>
            <div class="col-12 mt-3">
              <p class="mb-0"><strong>EMI: </strong><span id="emiResult">--</span></p>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-6" data-aos="fade-left">
        <div class="glass-card h-100">
          <h5 class="mb-3"><i class="bi bi-graph-up me-2"></i> Loan Eligibility</h5>
          <div class="row g-2">
            <div class="col-12 mb-2">
              <input type="number" id="income" class="form-control" placeholder="Monthly Income (₹)">
            </div>
            <div class="col-12 mb-2">
              <input type="number" id="existingEmi" class="form-control" placeholder="Existing EMI (₹)">
            </div>
            <div class="col-12 mt-2">
              <button class="btn btn-gradient w-100" type="button" onclick="checkEligibility()">Check Eligibility</button>
            </div>
            <div class="col-12 mt-3">
              <p class="mb-0"><strong>Eligible Loan: </strong><span id="eligibilityResult">--</span></p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- LOAN CATEGORIES -->
<section class="py-5" aria-label="Loan categories">
  <div class="container container-max">
    <h3 class="text-center mb-4 text-primary" data-aos="fade-up">Loan Categories</h3>
    <div class="row g-4 text-center">
      <div class="col-md-3" data-aos="fade-up" data-aos-delay="50">
        <div class="card h-100 shadow-sm border-0">
          <div class="card-body">
            <i class="bi bi-house-door-fill fs-2 text-primary mb-3"></i>
            <h6 class="fw-bold">Home Loan</h6>
            <p class="small text-muted">Buy your dream home with affordable EMIs.</p>
            <a href="#" class="btn btn-sm btn-outline-primary">Explore</a>
          </div>
        </div>
      </div>

      <div class="col-md-3" data-aos="fade-up" data-aos-delay="100">
        <div class="card h-100 shadow-sm border-0">
          <div class="card-body">
            <i class="bi bi-person-fill fs-2 text-success mb-3"></i>
            <h6 class="fw-bold">Personal Loan</h6>
            <p class="small text-muted">Quick cash for personal needs.</p>
            <a href="#" class="btn btn-sm btn-outline-success">Explore</a>
          </div>
        </div>
      </div>

      <div class="col-md-3" data-aos="fade-up" data-aos-delay="150">
        <div class="card h-100 shadow-sm border-0">
          <div class="card-body">
            <i class="bi bi-briefcase-fill fs-2 text-warning mb-3"></i>
            <h6 class="fw-bold">Business Loan</h6>
            <p class="small text-muted">Grow your business with flexible plans.</p>
            <a href="#" class="btn btn-sm btn-outline-warning">Explore</a>
          </div>
        </div>
      </div>

      <div class="col-md-3" data-aos="fade-up" data-aos-delay="200">
        <div class="card h-100 shadow-sm border-0">
          <div class="card-body">
            <i class="bi bi-car-front-fill fs-2 text-danger mb-3"></i>
            <h6 class="fw-bold">Car Loan</h6>
            <p class="small text-muted">Drive your dream car with easy financing.</p>
            <a href="#" class="btn btn-sm btn-outline-danger">Explore</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- OFFERS -->
<section class="py-5 offers" aria-label="Offers">
  <div class="container container-max">
    <h3 class="text-center mb-4" data-aos="fade-up">🔥 Trending Loan Offers</h3>
    <div class="row g-4">
      <div class="col-md-4" data-aos="zoom-in" data-aos-delay="100">
        <div class="card p-3 text-center">
          <h5>HDFC Bank</h5>
          <p>Personal Loans @ 10.5% onwards</p>
          <a href="#" class="btn btn-gradient btn-sm">Apply Now</a>
        </div>
      </div>
      <div class="col-md-4" data-aos="zoom-in" data-aos-delay="200">
        <div class="card p-3 text-center">
          <h5>SBI</h5>
          <p>Home Loans @ 8.5% onwards</p>
          <a href="#" class="btn btn-gradient btn-sm">Apply Now</a>
        </div>
      </div>
      <div class="col-md-4" data-aos="zoom-in" data-aos-delay="300">
        <div class="card p-3 text-center">
          <h5>ICICI Bank</h5>
          <p>Business Loans @ 11% onwards</p>
          <a href="#" class="btn btn-gradient btn-sm">Apply Now</a>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- PROMO -->
<section class="py-4 text-center" aria-label="Promo">
  <div class="container container-max">
    <div class="alert alert-info bg-opacity-10 text-info border-info">
      🎉 Special Offer: Zero processing fee on loans before <strong>30th Sept 2025</strong>!
    </div>
  </div>
</section>

<!-- TESTIMONIALS -->
<section class="py-5" aria-label="Testimonials">
  <div class="container container-max">
    <h3 class="text-center mb-4 text-info fw-bold" data-aos="fade-up">What Our Customers Say</h3>
    <div class="row g-4">
      <div class="col-md-4" data-aos="fade-right">
        <div class="glass-card h-100 text-center">
          <i class="bi bi-person-circle fs-1 text-warning"></i>
          <p class="mt-3">"Loan Saathi Hub made my home loan approval super easy. Very professional and quick process!"</p>
          <div class="text-warning">⭐⭐⭐⭐⭐</div>
          <h6 class="mt-2">- Rahul Sharma</h6>
        </div>
      </div>
      <div class="col-md-4" data-aos="fade-up">
        <div class="glass-card h-100 text-center">
          <i class="bi bi-person-circle fs-1 text-success"></i>
          <p class="mt-3">"I compared offers and found the lowest interest rate within minutes. Highly recommended!"</p>
          <div class="text-warning">⭐⭐⭐⭐☆</div>
          <h6 class="mt-2">- Priya Verma</h6>
        </div>
      </div>
      <div class="col-md-4" data-aos="fade-left">
        <div class="glass-card h-100 text-center">
          <i class="bi bi-person-circle fs-1 text-primary"></i>
          <p class="mt-3">"Great platform for business loans. Transparent process and no hidden charges."</p>
          <div class="text-warning">⭐⭐⭐⭐⭐</div>
          <h6 class="mt-2">- Ankit Mehta</h6>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- FAQ -->
<section class="py-5 bg-light" aria-label="FAQ">
  <div class="container container-max">
    <h3 class="text-center mb-4 text-primary fw-bold">Frequently Asked Questions</h3>
    <div class="accordion" id="faqAccordion">
      <div class="accordion-item">
        <h2 class="accordion-header" id="faq1">
          <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1">
            How do I apply for a loan?
          </button>
        </h2>
        <div id="collapse1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
          <div class="accordion-body">Register as an applicant, complete your profile, submit a loan request and wait for lenders' responses.</div>
        </div>
      </div>

      <div class="accordion-item">
        <h2 class="accordion-header" id="faq2">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2">
            Is my data safe on Loan Saathi Hub?
          </button>
        </h2>
        <div id="collapse2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
          <div class="accordion-body">Yes — we use encrypted storage and secure authentication to protect personal & financial data.</div>
        </div>
      </div>

      <div class="accordion-item">
        <h2 class="accordion-header" id="faq3">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3">
            What types of loans are available?
          </button>
        </h2>
        <div id="collapse3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
          <div class="accordion-body">We support Home, Personal, Business, Education and Vehicle loans.</div>
        </div>
      </div>

      <div class="accordion-item">
        <h2 class="accordion-header" id="faq4">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4">
            How long does loan approval take?
          </button>
        </h2>
        <div id="collapse4" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
          <div class="accordion-body">Approval time varies by lender — most complete document checks in 24–48 hours.</div>
        </div>
      </div>
    </div>
  </div>
</section>

{% endblock %}

{% block extra_js %}
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
  AOS.init({ duration: 900, once: true });

  function calculateEMI() {
    const P = parseFloat(document.getElementById("loanAmount")?.value) || 0;
    const R = (parseFloat(document.getElementById("interestRate")?.value) || 0) / 12 / 100;
    const N = parseFloat(document.getElementById("loanTenure")?.value) || 0;
    if (P > 0 && R > 0 && N > 0) {
      const emi = (P * R * Math.pow(1 + R, N)) / (Math.pow(1 + R, N) - 1);
      document.getElementById("emiResult").innerText = "₹" + emi.toFixed(2);
    } else {
      document.getElementById("emiResult").innerText = "--";
    }
  }

  function checkEligibility() {
    const income = parseFloat(document.getElementById("income")?.value) || 0;
    const emi = parseFloat(document.getElementById("existingEmi")?.value) || 0;
    if (income > 0) {
      const eligible = Math.max(0, (income - emi)) * 60;
      document.getElementById("eligibilityResult").innerText = "₹" + eligible.toFixed(0);
    } else {
      document.getElementById("eligibilityResult").innerText = "--";
    }
  }
</script>
{% endblock %}