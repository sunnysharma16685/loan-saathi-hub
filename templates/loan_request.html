{% extends "base.html" %}

{% block title %}User Dashboard - LoanSaathiHub{% endblock %}

{% block header_buttons %}
<!-- Top right buttons -->
<a href="{{ url_for('index') }}" class="btn btn-sm btn-light me-2">Home</a>
<a href="{{ url_for('logout') }}" class="btn btn-sm btn-danger">Logout</a>
{% endblock %}

{% block content %}
<div class="container mt-4">
  <h3>Welcome, {{ user.first_name }}!</h3>
  <p>Your dashboard content will appear here.</p>

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h4>Your Loan Requests</h4>
    <a href="{{ url_for('loan_request') }}" class="btn btn-primary">New Loan</a>
  </div>

  {% if loans %}
  <div class="table-responsive">
    <table class="table table-bordered table-striped">
      <thead class="table-light">
        <tr>
          <th>Loan ID</th>
          <th>Loan Type</th>
          <th>Amount Requested</th>
          <th>Duration (Months)</th>
          <th>Status</th>
          <th>Remarks</th>
          <th>Agent Details</th>
        </tr>
      </thead>
      <tbody>
        {% for loan in loans %}
        <tr>
          <td>{{ loan.loan_id }}</td>
          <td>{{ loan.loan_type }}</td>
          <td>₹ {{ loan.amount }}</td>
          <td>{{ loan.duration }}</td>
          <td>
            {% if loan.status == "pending" %}
              <span class="badge bg-warning text-dark">Pending</span>
            {% elif loan.status == "active" %}
              <span class="badge bg-info text-dark">Active</span>
            {% elif loan.status == "rejected" %}
              <span class="badge bg-danger">Rejected</span>
            {% elif loan.status == "approved" %}
              <span class="badge bg-success">Approved</span>
            {% else %}
              {{ loan.status }}
            {% endif %}
          </td>
          <td>
            {% if loan.status == "rejected" %}
              {{ loan.remark or "No reason provided" }}
            {% elif loan.status == "approved" %}
              {{ loan.remark or "No remark" }}
            {% else %}
              -
            {% endif %}
          </td>
          <td>
            {% if loan.status == "approved" %}
              <strong>{{ loan.agent_name }}</strong><br/>
              Mobile: {{ loan.agent_mobile }}<br/>
              Type: {{ loan.agent_type }}<br/>
              {{ loan.agent_other_details or "" }}
            {% else %}
              -
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
    <p>No loan requests found.</p>
  {% endif %}
</div>
{% endblock %}
{% extends "base.html" %}

{% block title %}New Loan Request - LoanSaathiHub{% endblock %}

{% block header_buttons %}
<a href="{{ url_for('dashboard_user') }}" class="btn btn-sm btn-light me-2">Back to Dashboard</a>
<a href="{{ url_for('logout') }}" class="btn btn-sm btn-danger">Logout</a>
{% endblock %}

{% block content %}
<div class="container mt-4">
  <h3>New Loan Request</h3>
  <form method="POST" action="{{ url_for('loan_request') }}">
    <div class="mb-3">
      <label for="loan_type" class="form-label">Loan Type</label>
      <select class="form-select" id="loan_type" name="loan_type" required>
        <option value="" selected disabled>Select Loan Type</option>
        <option>Home Loan</option>
        <option>Personal Loan</option>
        <option>Vehicle Loan</option>
        <option>Gold Loan</option>
        <option>Mudra Loan</option>
        <option>Business Loan</option>
        <option>Overdraft (OD) Loan</option>
      </select>
    </div>

    <div class="mb-3">
      <label for="amount" class="form-label">Amount Requested (₹)</label>
      <input type="number" class="form-control" id="amount" name="amount" min="1" required>
    </div>

    <div class="mb-3">
      <label for="duration" class="form-label">Duration (Months)</label>
      <input type="number" class="form-control" id="duration" name="duration" min="1" required>
    </div>

    <div class="mb-3">
      <label for="remark" class="form-label">Reason for Loan</label>
      <textarea class="form-control" id="remark" name="remark" rows="3" placeholder="Please describe your reason for this loan..." required></textarea>
    </div>

    <button type="submit" class="btn btn-primary">Submit Loan Request</button>
  </form>
</div>
{% endblock %}
