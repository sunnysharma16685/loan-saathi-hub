{% extends "base.html" %}
{% block title %}Complete Profile | LoanSaathiHub{% endblock %}
{% block description %}Fill your personal, address, employment, and financial details to request a loan on LoanSaathiHub.{% endblock %}
{% block content %}
<div class="form-container">
  <h2>Welcome, {{ user.first_name }}</h2>
  <form method="post" action="/user-details">
    <h3>Personal Information</h3>
    <input type="date" name="dob" required>
    <div>
      <label>Marital Status</label><br>
      <input type="radio" name="marital_status" value="Single"> Single
      <input type="radio" name="marital_status" value="Married"> Married
      <input type="radio" name="marital_status" value="Other"> Other
    </div>
    <h3>Address Details</h3>
    <input type="text" name="street_1" placeholder="Street Address" required>
    <input type="text" name="street_2" placeholder="Street Address 2">
    <input type="text" id="pincode" name="pincode" placeholder="PIN Code" required>
    <input type="text" id="city" name="city" placeholder="City" readonly required>
    <input type="text" id="state" name="state" placeholder="State" readonly required>
    <select name="address_type" required>
      <option value="">Select Address Type</option>
      <option value="On Rent">On Rent</option>
      <option value="Owner">Owner</option>
      <option value="Parents">Parents</option>
      <option value="Other">Other</option>
    </select>

    <h3>Employment Details</h3>
    <select name="job_type">
      <option value="">Job Type</option>
      <option value="Pvt. Company">Pvt. Company</option>
      <option value="Govt. Company">Govt. Company</option>
      <option value="PSU">PSU</option>
    </select>
    <select name="designation">
      <option value="">Designation</option>
      <option value="Manager">Manager</option>
      <option value="Executive">Executive</option>
      <option value="Developer">Developer</option>
      <option value="Other">Other</option>
    </select>
    <input type="number" name="monthly_salary" placeholder="Monthly Salary" required>
    <input type="number" name="other_income" placeholder="Bonus/Commission (Yearly)">

    <h3>Business Details</h3>
    <select name="business_type">
      <option value="">Business Type</option>
      <option value="Proprietor firm">Proprietor firm</option>
      <option value="Pvt. Ltd. firm">Pvt. Ltd. firm</option>
      <option value="Ltd. firm">Ltd. firm</option>
      <option value="LLP firm">LLP firm</option>
      <option value="Builder">Builder</option>
      <option value="CA">CA</option>
      <option value="Police">Police</option>
      <option value="Advocate">Advocate</option>
      <option value="Other">Other</option>
    </select>
    <input type="number" name="turnover" placeholder="Total Turnover (Last Year)">

    <h3>Financial Profile</h3>
    <label>ITR:</label><br>
    <input type="radio" name="itr" value="Last 3 years"> Last 3 Years
    <input type="radio" name="itr" value="Last 2 years"> Last 2 Years
    <input type="radio" name="itr" value="Last 1 year"> Last 1 Year
    <input type="radio" name="itr" value="No ITR"> No ITR
    <input type="text" name="cibil" placeholder="CIBIL Score (if known)">

    <h3>Required Loan Details</h3>
    <select name="loan_type" required>
      <option value="">Select Loan Type</option>
      <option value="Personal">Personal</option>
      <option value="Business">Business</option>
      <option value="Home">Home</option>
    </select>
    <input type="number" name="loan_amount" placeholder="Loan Amount Required" required>
    <input type="number" name="loan_duration" placeholder="Loan Duration (in months)" required>
    <button type="submit">Finish</button>
  </form>
</div>
<script>
  document.getElementById("pincode").addEventListener("blur", function () {
    const pin = this.value;
    if (pin.length === 6) {
      fetch(`https://api.postalpincode.in/pincode/${pin}`)
        .then(res => res.json())
        .then(data => {
          if (data[0].Status === "Success") {
            document.getElementById("city").value = data[0].PostOffice[0].District;
            document.getElementById("state").value = data[0].PostOffice[0].State;
          } else {
            alert("Invalid PIN Code");
            document.getElementById("city").value = '';
            document.getElementById("state").value = '';
          }
        });
    }
  });
</script>
{% endblock %}