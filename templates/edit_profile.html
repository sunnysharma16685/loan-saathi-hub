{% extends "base.html" %}
{% block content %}
<style>
  body { font-family: 'Poppins', sans-serif; background: #f5f8fa; }
  .container { max-width: 1000px; margin-top: 30px; }
  h2, h4, h5 { color:#333; margin-top: 20px; }
  form { background:#fff; padding:25px; border-radius:12px; box-shadow:0 8px 16px rgba(0,0,0,0.1); }
  label { font-weight:600; color:#555; margin-top:10px; display:block; }
  input, select, textarea { width:100%; padding:10px; border:1px solid #ccc; border-radius:6px; margin-top:5px; transition:0.3s; }
  input:focus, select:focus, textarea:focus { border-color:#0d6efd; outline:none; box-shadow:0 0 5px rgba(0,0,0,0.1); }
  .readonly-field { background-color:#f8f9fa; border:1px solid #ddd; pointer-events:none; filter:blur(1px); color:#6c757d; }
  button { background:#0d6efd; color:#fff; border:none; padding:12px; border-radius:6px; cursor:pointer; margin-top:15px; width:100%; font-weight:600; transition:0.3s; }
  button:hover { background:#084298; }
  .btn-secondary { background:#6c757d; color:#fff; }
  .btn-secondary:hover { background:#495057; }
</style>

<div class="container">
  <h2>Edit Profile</h2>
  <form method="POST">
    {% csrf_token %}
    <!-- Common Profile -->
    <h4>Basic Information</h4>
    <div class="row g-3">
      <div class="col-md-6">
        <label>Full Name</label>
        <input type="text" name="fullName" class="form-control readonly-field" value="{{ profile.full_name }}" readonly>
      </div>
      <div class="col-md-6">
        <label>Mobile</label>
        <input type="text" name="mobile" class="form-control readonly-field" value="{{ profile.mobile }}" readonly>
      </div>
      <div class="col-md-6">
        <label>Gender</label>
        <input type="text" name="gender" class="form-control" value="{{ profile.gender }}">
      </div>
      <div class="col-md-6">
        <label>Marital Status</label>
        <input type="text" name="maritalStatus" class="form-control" value="{{ profile.marital_status }}">
      </div>
      <div class="col-md-6">
        <label>Address</label>
        <textarea name="address" class="form-control">{{ profile.address }}</textarea>
      </div>
      <div class="col-md-3">
        <label>Pincode</label>
        <input type="text" name="pincode" class="form-control" value="{{ profile.pincode }}">
      </div>
      <div class="col-md-3">
        <label>City</label>
        <input type="text" name="city" class="form-control" value="{{ profile.city }}">
      </div>
      <div class="col-md-3">
        <label>State</label>
        <input type="text" name="state" class="form-control" value="{{ profile.state }}">
      </div>
      <div class="col-md-3">
        <label>PANCARD Number</label>
        <input type="text" name="pancardNumber" class="form-control readonly-field" value="{{ profile.pancard_number }}" readonly>
      </div>
      <div class="col-md-3">
        <label>Aadhaar Number</label>
        <input type="text" name="aadhaarNumber" class="form-control readonly-field" value="{{ profile.aadhaar_number }}" readonly>
      </div>
      <div class="col-md-3">
        <label>Date of Birth</label>
        <input type="date" name="dob" class="form-control readonly-field" value="{{ profile.dob|date:'Y-m-d' }}" readonly>
      </div>
    </div>

    {% if user.role == "applicant" %}
      <hr>
      <h4>Applicant Details</h4>
      <div class="row g-3">
        <div class="col-md-4"><label>Job Type</label><input type="text" name="jobType" class="form-control" value="{{ applicant_details.job_type }}"></div>
        <div class="col-md-4"><label>Employment Type</label><input type="text" name="employmentType" class="form-control" value="{{ applicant_details.employment_type }}"></div>
        <div class="col-md-4"><label>CIBIL Score</label><input type="number" name="cibilScore" class="form-control" value="{{ applicant_details.cibil_score }}"></div>
      </div>

      <h5>Job Information</h5>
      <div class="row g-3">
        <div class="col-md-4"><label>Company Name</label><input type="text" name="companyName" class="form-control" value="{{ applicant_details.company_name }}"></div>
        <div class="col-md-4"><label>Company Type</label><input type="text" name="companyType" class="form-control" value="{{ applicant_details.company_type }}"></div>
        <div class="col-md-4"><label>Designation</label><input type="text" name="designation" class="form-control" value="{{ applicant_details.designation }}"></div>
        <div class="col-md-4"><label>ITR</label><input type="text" name="itrJob" class="form-control" value="{{ applicant_details.itr }}"></div>
        <div class="col-md-4"><label>Current Salary</label><input type="number" step="0.01" name="currentSalary" class="form-control" value="{{ applicant_details.current_salary }}"></div>
        <div class="col-md-4"><label>Other Income</label><input type="number" step="0.01" name="otherIncome" class="form-control" value="{{ applicant_details.other_income }}"></div>
        <div class="col-md-4"><label>Total EMI (Job)</label><input type="number" step="0.01" name="totalEmiJob" class="form-control" value="{{ applicant_details.total_emi }}"></div>
      </div>

      <h5>Business Information</h5>
      <div class="row g-3">
        <div class="col-md-4"><label>Business Name</label><input type="text" name="businessName" class="form-control" value="{{ applicant_details.business_name }}"></div>
        <div class="col-md-4"><label>Business Type</label><input type="text" name="businessType" class="form-control" value="{{ applicant_details.business_type }}"></div>
        <div class="col-md-4"><label>Business Sector</label><input type="text" name="businessSector" class="form-control" value="{{ applicant_details.business_sector }}"></div>
        <div class="col-md-4"><label>Total Turnover (3Y)</label><input type="number" step="0.01" name="turnover3y" class="form-control" value="{{ applicant_details.total_turnover }}"></div>
        <div class="col-md-4"><label>Last Year Turnover</label><input type="number" step="0.01" name="turnover1y" class="form-control" value="{{ applicant_details.last_year_turnover }}"></div>
        <div class="col-md-4"><label>Total EMI (Business)</label><input type="number" step="0.01" name="totalEmiBusiness" class="form-control" value="{{ applicant_details.business_total_emi }}"></div>
        <div class="col-md-4"><label>Business ITR Status</label><input type="text" name="itrBusiness" class="form-control" value="{{ applicant_details.business_itr_status }}"></div>
      </div>

    {% elif user.role == "lender" %}
      <hr>
      <h4>Lender Details</h4>
      <div class="row g-3">
        <div class="col-md-4"><label>Lender Type</label><input type="text" name="lenderType" class="form-control" value="{{ lender_details.lender_type }}"></div>
        <div class="col-md-4"><label>DSA Code</label><input type="text" name="dsaCode" class="form-control" value="{{ lender_details.dsa_code }}"></div>
        <div class="col-md-4"><label>Bank/Firm Name</label><input type="text" name="firmName" class="form-control" value="{{ lender_details.bank_firm_name }}"></div>
        <div class="col-md-4"><label>GST Number</label><input type="text" name="gstNumber" class="form-control" value="{{ lender_details.gst_number }}"></div>
        <div class="col-md-4"><label>Branch Name</label><input type="text" name="branchName" class="form-control" value="{{ lender_details.branch_name }}"></div>
        <div class="col-md-4"><label>Designation</label><input type="text" name="designation" class="form-control" value="{{ lender_details.designation }}"></div>
      </div>
    {% endif %}

    <button type="submit">Save Changes</button>
    <a href="{% url 'view_profile' user.id %}" class="btn btn-secondary mt-2">Cancel</a>
  </form>
</div>
{% endblock %}
