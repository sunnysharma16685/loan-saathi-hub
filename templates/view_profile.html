{% extends "base.html" %}
{% block title %}Full Profile — Loan Saathi Hub{% endblock %}

{% block extra_head %}
<style>
  body { font-family:'Poppins',sans-serif; background:#f6f8fb; }
  .profile-wrapper { max-width:960px; margin:30px auto; }
  .card {
    background:#fff; border-radius:12px;
    box-shadow:0 6px 18px rgba(0,0,0,0.06);
    padding:20px; margin-bottom:24px;
  }
  h2 { font-size:26px; font-weight:700; margin-bottom:20px; text-align:center; }
  h4 { font-size:20px; font-weight:600; margin-bottom:16px; border-bottom:2px solid #f1f3f5; padding-bottom:6px; }
  h5 { font-size:17px; font-weight:600; margin-top:14px; margin-bottom:10px; }
  p { margin-bottom:8px; color:#444; }
  table { width:100%; border-collapse:collapse; margin-top:12px; }
  th, td { padding:10px 12px; border:1px solid #e9ecef; text-align:left; }
  th { background:#0d6efd; color:#fff; width:220px; font-weight:500; }
  .btn-back {
    display:inline-block; background:#6c757d; color:#fff;
    padding:10px 18px; border-radius:8px; text-decoration:none;
    font-weight:600; transition:0.3s;
  }
  .btn-back:hover { background:#5a6268; }
</style>
{% endblock %}

{% block content %}

{% if request.user.role == 'applicant' %}
  {% url 'dashboard_applicant' as dashboard_url %}
{% elif request.user.role == 'lender' %}
  {% url 'dashboard_lender' as dashboard_url %}
{% else %}
  {% url 'index' as dashboard_url %}
{% endif %}

<div class="profile-wrapper">
  <h2>Applicant Full Profile (Unlocked after Payment)</h2>

  <!-- Basic Information -->
  <div class="card">
    <h4>Basic Information</h4>
    <p><strong>Full Name:</strong> {{ profile.full_name|default:"N/A" }}</p>
    <p><strong>Email:</strong> {{ applicant.email }}</p>
    <p><strong>Mobile:</strong> {{ profile.mobile|default:"N/A" }}</p>
    <p><strong>Gender:</strong> {{ profile.gender|default:"N/A" }}</p>
    <p><strong>Marital Status:</strong> {{ profile.marital_status|default:"N/A" }}</p>
    <p><strong>Address:</strong>
      {{ profile.address|default:"" }}
      {% if profile.city %}, {{ profile.city }}{% endif %}
      {% if profile.state %}, {{ profile.state }}{% endif %}
      {% if profile.pincode %} - {{ profile.pincode }}{% endif %}
    </p>
    <p><strong>PAN Number:</strong> {{ profile.pancard_number }}</p>
    <p><strong>Aadhaar Number:</strong> {{ profile.aadhaar_number|default:"N/A" }}</p>
    <p><strong>Date of Birth:</strong> {{ profile.dob|date:"d-m-Y"|default:"N/A" }}</p>
  </div>

  <!-- Applicant Details -->
  <div class="card">
    <h4>Applicant Details</h4>
    <p><strong>Employment Type:</strong> {{ applicant_details.employment_type|default:"N/A" }}</p>
    <p><strong>CIBIL Score:</strong> {{ applicant_details.cibil_score|default:"N/A" }}</p>

    {% if applicant_details.employment_type == "Job" %}
      <h5>Job Information</h5>
      <p><strong>Company Name:</strong> {{ applicant_details.company_name|default:"N/A" }}</p>
      <p><strong>Company Type:</strong> {{ applicant_details.company_type|default:"N/A" }}</p>
      <p><strong>Designation:</strong> {{ applicant_details.designation|default:"N/A" }}</p>
      <p><strong>ITR:</strong> {{ applicant_details.itr|default:"N/A" }}</p>
      <p><strong>Current Salary:</strong> ₹{{ applicant_details.current_salary|default:"0" }}</p>
      <p><strong>Other Income:</strong> ₹{{ applicant_details.other_income|default:"0" }}</p>
      <p><strong>Total EMI:</strong> ₹{{ applicant_details.total_emi|default:"0" }}</p>

    {% elif applicant_details.employment_type == "Business" %}
      <h5>Business Information</h5>
      <p><strong>Business Name:</strong> {{ applicant_details.business_name|default:"N/A" }}</p>
      <p><strong>Business Type:</strong> {{ applicant_details.business_type|default:"N/A" }}</p>
      <p><strong>Business Sector:</strong> {{ applicant_details.business_sector|default:"N/A" }}</p>
      <p><strong>Total Turnover (3Y):</strong> ₹{{ applicant_details.total_turnover|default:"0" }}</p>
      <p><strong>Last Year Turnover:</strong> ₹{{ applicant_details.last_year_turnover|default:"0" }}</p>
      <p><strong>Total EMI (Business):</strong> ₹{{ applicant_details.business_total_emi|default:"0" }}</p>
      <p><strong>Business ITR Status:</strong> {{ applicant_details.business_itr_status|default:"N/A" }}</p>
    {% endif %}
  </div>

  <!-- Loan Details -->
  <div class="card">
    <h4>Loan Details</h4>
    <table>
      <tbody>
        <tr><th>Loan ID</th><td>{{ loan.loan_id|default:"N/A" }}</td></tr>
        <tr><th>Amount Requested</th><td>₹{{ loan.amount_requested|default:"0" }}</td></tr>
        <tr><th>Reason for Loan</th><td>{{ loan.reason_for_loan|default:"N/A" }}</td></tr>
        <tr><th>Duration</th><td>{{ loan.duration_months|default:"0" }} months</td></tr>
        <tr><th>Interest Rate</th><td>{{ loan.interest_rate|default:"0" }}%</td></tr>
        <tr><th>Status</th><td>{{ loan.status|default:"N/A" }}</td></tr>
        <tr><th>Created At</th><td>{{ loan.created_at|date:"d-m-Y H:i"|default:"N/A" }}</td></tr>
      </tbody>
    </table>
  </div>

  <!-- Back Button -->
  <div class="text-center">
    <a href="{{ dashboard_url }}" class="btn-back">← Back to Dashboard</a>
  </div>
</div>
{% endblock %}
